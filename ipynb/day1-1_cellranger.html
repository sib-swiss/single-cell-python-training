<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Cell Ranger – Single-cell transcriptomics with Python</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../assets/SIB_logo.svg" rel="icon" type="image/svg+xml">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro">
<!-- Matomo -->
<script>
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://matomo.sib.swiss/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '220']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->


</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Single-cell transcriptomics with Python</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../precourse_preparations.html"> 
<span class="menu-text">Pre-course preparations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../course_schedule.html"> 
<span class="menu-text">Course schedule</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-day-1" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">day 1</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-day-1">    
        <li>
    <a class="dropdown-item" href="../ipynb/day1-1_setup.html">
 <span class="dropdown-text">Setup</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../ipynb/day1-1_cellranger.html">
 <span class="dropdown-text">Cell Ranger</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../ipynb/day1-2_analysis_tools_qc.html">
 <span class="dropdown-text">Analysis tools and quality control (QC)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../ipynb/day1-3_normalization_scaling.html">
 <span class="dropdown-text">Normalization</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-day-2" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">day 2</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-day-2">    
        <li>
    <a class="dropdown-item" href="../ipynb/day2-1_dimensionality_reduction.html">
 <span class="dropdown-text">Dimensionality Reduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../ipynb/day2-2_integration.html">
 <span class="dropdown-text">Data Integration</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../ipynb/day2-3_clustering.html">
 <span class="dropdown-text">Clustering</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../ipynb/day2-4_visualization.html">
 <span class="dropdown-text">Cell type annotation and visualization</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-day-3" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">day 3</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-day-3">    
        <li>
    <a class="dropdown-item" href="../ipynb/day3-1_tf.html">
 <span class="dropdown-text">Gene regulatory analysis with pySCENIC</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../ipynb/day3-3_trajectory_analysis.html">
 <span class="dropdown-text">Trajectory Inference and Pseudotime</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../ipynb/day3-4_velocity1.html">
 <span class="dropdown-text">RNA velocity with scvelo</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../ipynb/day3-4_velocity2.html">
 <span class="dropdown-text">RNA velocity with VeloCycle</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/sib-swiss/single-cell-python-training/"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Cell Ranger</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../assets/SIB_LogoQ_GBv.svg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#learning-outcomes" id="toc-learning-outcomes" class="nav-link active" data-scroll-target="#learning-outcomes">Learning outcomes</a></li>
  <li><a href="#running-cellranger-count" id="toc-running-cellranger-count" class="nav-link" data-scroll-target="#running-cellranger-count">Running <code>cellranger count</code></a></li>
  <li><a href="#cloud-serverlinuxmacoswsl" id="toc-cloud-serverlinuxmacoswsl" class="nav-link" data-scroll-target="#cloud-serverlinuxmacoswsl">Cloud server/Linux/MacOS/WSL</a></li>
  <li><a href="#windows-only-relevant-if-working-locally" id="toc-windows-only-relevant-if-working-locally" class="nav-link" data-scroll-target="#windows-only-relevant-if-working-locally">Windows (only relevant if working locally)</a></li>
  <li><a href="#data-overview" id="toc-data-overview" class="nav-link" data-scroll-target="#data-overview">Data overview</a>
  <ul class="collapse">
  <li><a href="#this-will-take-a-while" id="toc-this-will-take-a-while" class="nav-link" data-scroll-target="#this-will-take-a-while">This will take a while…</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Cell Ranger</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<style>
    .large-link {
        font-size: 30px;
        font-family: Arial, sans-serif;
        color: #333;
        text-decoration: none;
    }
</style>
<p><a href="../assets/pdf/01_introduction.pdf" target="_blank" class="large-link">Download Presentation: General introduction</a></p>
<style>
    .large-link {
        font-size: 30px;
        font-family: Arial, sans-serif;
        color: #333;
        text-decoration: none;
    }
</style>
<p><a href="../assets/pdf/02_introduction_scRNAseq.pdf" target="_blank" class="large-link">Download Presentation: Introduction to scRNA-seq</a></p>
<style>
    .large-link {
        font-size: 30px;
        font-family: Arial, sans-serif;
        color: #333;
        text-decoration: none;
    }
</style>
<p><a href="../assets/pdf/03_cellranger.pdf" target="_blank" class="large-link">Download Presentation: Introduction to Cell Ranger</a></p>
<section id="learning-outcomes" class="level2">
<h2 class="anchored" data-anchor-id="learning-outcomes">Learning outcomes</h2>
<p><strong>After having completed this chapter you will be able to:</strong></p>
<ul>
<li>Explain what kind of information single-cell RNA-seq (scRNA-seq) can give you to answer a biological question</li>
<li>Describe essential considerations during the design of a single-cell RNA-seq experiment</li>
<li>Describe the pros and cons of different single-cell sequencing methods</li>
<li>Use cellranger to:
<ul>
<li>To align reads and generate count tables</li>
<li>Perform basic QC on alignments and counts</li>
</ul></li>
</ul>
</section>
<section id="running-cellranger-count" class="level2">
<h2 class="anchored" data-anchor-id="running-cellranger-count">Running <code>cellranger count</code></h2>
<p>The exercises below assume that you are enrolled in the course, and have access to the server. <strong>These exercises are not essential to run for the rest of the course</strong>, so you can skip them. If you want to do them anyway, you can try to <a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/installation">install <code>cellranger</code> locally</a> (only on Linux or WSL). In addition, you will need to download the references. You can get it by with this code (choose your OS):</p>
</section>
<section id="cloud-serverlinuxmacoswsl" class="level2">
<h2 class="anchored" data-anchor-id="cloud-serverlinuxmacoswsl">Cloud server/Linux/MacOS/WSL</h2>
<p>Run the following commands in the terminal or other command line prompt application:</p>
<pre><code>    wget https://single-cell-transcriptomics.s3.eu-central-1.amazonaws.com/cellranger_index.tar.gz
    tar -xvf cellranger_index.tar.gz
    rm cellranger_index.tar.gz</code></pre>
</section>
<section id="windows-only-relevant-if-working-locally" class="level2">
<h2 class="anchored" data-anchor-id="windows-only-relevant-if-working-locally">Windows (only relevant if working locally)</h2>
<p>If you are working on the cloud server, follow the instructions above. Download using the <a href="https://single-cell-transcriptomics.s3.eu-central-1.amazonaws.com/cellranger_index.tar.gz">link</a>, and unpack in your working directory. This will download and extract the index in the current directory. Specify the path to this reference in the exercises accordingly.</p>
</section>
<section id="data-overview" class="level2">
<h2 class="anchored" data-anchor-id="data-overview">Data overview</h2>
<p>Have a look in the directory <code>course_data/reads</code> and <code>cellranger_index</code>. In the <code>reads</code> directory you will find reads on one sample: <code>ETV6-RUNX1_1</code>. In the analysis part of the course we will work with six samples, but due to time and computational limitations we will run <code>cellranger count</code> on one of the samples, and only reads originating from chromsome 21 and 22.</p>
<p>The input you need to run <code>cellranger count</code> are the sequence reads and a reference. Here, we have prepared a reference only with chromosome 21 and 22, but in ‘real life’ you would of course get the full reference genome of your species. The reference has a specific format. You can download precomputed human and mouse references from the <a href="https://support.10xgenomics.com/single-cell-gene-expression/software/downloads/latest">10X website</a>. If your species of interest is not one of those, you will have to generate it yourself. For that, have a look <a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/using/tutorial_mr">here</a>.</p>
<p>To be able to run cellranger in the compute environment, first run:</p>
<pre><code>export PATH=/data/cellranger-8.0.1:$PATH</code></pre>
<p>Have a look at the documentation of <a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/using/count"><code>cellranger count</code></a> (scroll down to <em>Command-line argument reference</em>).</p>
<p>You can find the input files here:</p>
<ul>
<li>reads: <code>course_data/reads/</code> (from the downloaded tar package in your home directory)</li>
<li>pre-indexed reference: <code>cellranger_index</code></li>
</ul>
<p><strong>Exercise 1</strong>: Fill out the missing arguments (at <code>FIXME</code>) in the script below, and run it:</p>
<pre><code>cellranger count \
--id=FIXME \
--sample=FIXME \
--transcriptome=FIXME \
--fastqs=FIXME \
--localcores=4 \
--create-bam=true</code></pre>
<section id="this-will-take-a-while" class="level3">
<h3 class="anchored">This will take a while…</h3>
<p>Once started, the process will need approximately 15 minutes to finish. Have a coffee and/or have a look at the other exercises.</p>
<button onclick="toggleVisibility('answer1')">
Click for Answer
</button>
<div id="answer1" style="display:none;">
<pre>    cellranger count \
    --id=ETV6-RUNX1_1 \
    --sample=ETV6-RUNX1_1 \
    --transcriptome=cellranger_index \
    --fastqs=course_data/reads \
    --localcores=4 \
    --create-bam=true
</pre>
<script>
function toggleVisibility(id) {
   var element = document.getElementById(id);
   if (element.style.display === 'none') {
       element.style.display = 'block';
   } else {
       element.style.display = 'none';
   }
}
</script>
<section id="opening-cellranger-output" class="level2">
<h2 class="anchored" data-anchor-id="opening-cellranger-output">Opening <code>cellranger</code> output</h2>
<p>Have a look out the output directory (i.e.&nbsp;<code>~/ETV6-RUNX1_1/outs</code>). The analysis report (<code>web_summary.html</code>) is usually a good place to start.</p>
<p><strong>Exercise 2</strong>: Have a good look inside <code>web_summary.html</code>. Anything that draws your attention? Is this report good enough to continue the analysis?</p>
<button onclick="toggleVisibility('answer2')">
Click for Answer
</button>
<div id="answer2" style="display:none;">
<p>Not really. First of all there is a warning: <code>Fraction of RNA read bases with Q-score &gt;= 30 is low</code>. This means that there is a low base quality of the reads. A low base quality gives results in more sequencing error and therefore possibly lower performance while mapping the reads to genes. However, a Q-score of 30 still represents 99.9% accuracy.</p>
<p>What should worry us more is the <strong>number of reads per cell</strong> (363) and the <strong>sequencing saturation</strong> (7.9%). In most cases you should aim for 30.000 - 50.000 reads per cell (depending on the application). We therefore don’t have enough reads per cell. However, as you might remember, this was a subset of reads (1 million) mapped against chromosome 21 &amp; 22, while the original dataset contains 210,987,037 reads. You can check out the original report at <code>course_data/count_matrices/ETV6-RUNX1_1/outs/web_summary.html</code>.</p>
For more info on sequencing saturation, have a look <a href="https://kb.10xgenomics.com/hc/en-us/articles/115002474263-How-much-sequencing-saturation-should-I-aim-for-">here</a>.
<script>
function toggleVisibility(id) {
   var element = document.getElementById(id);
   if (element.style.display === 'none') {
       element.style.display = 'block';
   } else {
       element.style.display = 'none';
   }
}
</script>
<section id="understanding-the-cellranger-output" class="level2">
<h2 class="anchored" data-anchor-id="understanding-the-cellranger-output">Understanding the CellRanger output</h2>
<p>The run summary from cellranger count can be viewed by clicking “Summary” in the top left corner. The summary metrics describe sequencing quality and various characteristics of the detected cells. Similar web summaries are also output from the <code>cellranger reanalyze</code> and <code>cellranger aggr</code> pipelines.</p>
<p>This report will serve you as first-line feedback on how the experiment went. It provides an easily accessible summary to scrutinize the success of the experiment.</p>
<p>It will help answering the questions like:</p>
<ul>
<li>What is the quality of the run?</li>
<li>How many cells do you have?</li>
<li>Is the cell count estimate credible?</li>
<li>Was the sample sequenced deep enough? Where the cells intact and well?</li>
<li>Is the quality of the cells uniform?</li>
</ul>
<p>Note that some of these questions will be more definitively answered during a successive (more hands-on) part of quality control (QC) process. Consider this just the beginning of the scrutiny.</p>
<p><strong>Basic QC metrics</strong></p>
<p>The number of cells detected, the mean reads per cell, and the median genes detected per cell are prominently displayed near the top of the page.</p>
<p><img src="Aspose.Words.2e953e9a-44c0-496e-9758-25b7bd47b079.002.jpeg" class="img-fluid"></p>
<p><em>Estimated Cell number:</em> This is determined from the number of cell barcodes with a ‘reasonable’ numbers of observations. This number is an <em>estimate</em> because there is no binary flag “full/empty” that tell us if a droplet had a cell inside or not. Every droplet will enter in contact with some free-floating RNA, therefore some threshold needs to be set to cell-associated barcodes vs noise from empty GEMs. However, this threshold cannot be a fixed number as it will depend on the overall quality of the experiment, size of the cells and depth of the sequences and mis-called sequences. So, this number automatically estimated from the “Barcode Rank Plot” that we will see below.</p>
<p>Note: this number is estimated using the thresholds to <code>cellranger count</code> as a bias, if the threshold is changed the count can give different predictions, and in some cases it will be necessary to do so. For example: to account for a not-so-successful experiment with high level of free-floating mRNA in the input cell suspension or a lysis caused mixing the RT mix with the cell suspension.</p>
<p><em>Mean Read per cell:</em> This is the mean of sequencing reads that is obtained on average to the cells. Note that this refers only to the ones counted in “Estimated number of cells” and therefore:</p>
<p><em>Estimated_Cell_number * Mean_Read_per_cell ≠ Illumina_Reads</em>.</p>
<p>Also note that this number DOES NOT correspond to the number of UMI per cells (the value that is actually used for the analysis).</p>
<p><strong>Exercise 3</strong>: On the basis of what learned in the lectures and above, can you explain how “Mean Reads per cell” and “UMI count” are related? How is “UMI count” obtained by the pipeline? Will doubling the number of reads double the number of UMIs?</p>
<button onclick="toggleVisibility('answer3')">
Click for Answer
</button>
<div id="answer3" style="display:none;">
<p>The mean reads per cell is the number of FASTQ READS containing a cell barcode assigned to a particular cell. The UMI count is the number of unique RNA MOLECULES that were sequenced assigned to a particular gene and cell. The cellranger pipeline determines the UMI count using the UMI barcode, which is different from the cell barcode. The UMI barcode is unique to each distinct RNA molecule in a cell. So, there is a possibility of multiple reads containing the same UMI barcode and being “collapsed” into a single count for the UMI count.</p>
Doubling the number of reads will likely increase the number of UMIs, due to the detection of new RNA molecules with increased sequencing depth, but it will not double the number of UMIs because many additional reads will be assigned to the same RNA/UMI barcode.
<script>
function toggleVisibility(id) {
   var element = document.getElementById(id);
   if (element.style.display === 'none') {
       element.style.display = 'block';
   } else {
       element.style.display = 'none';
   }
}
</script>
<section id="diagnostics" class="level2">
<h2 class="anchored" data-anchor-id="diagnostics">Diagnostics</h2>
<section id="qc-metrics-sequencing" class="level3">
<h3 class="anchored" data-anchor-id="qc-metrics-sequencing">QC metrics – Sequencing</h3>
<p><img src="Aspose.Words.2e953e9a-44c0-496e-9758-25b7bd47b079.003.jpeg" class="img-fluid"></p>
<section id="number-of-reads" class="level4">
<h4 class="anchored" data-anchor-id="number-of-reads">Number of Reads</h4>
<p>Total number of read pairs that were assigned to this library in demultiplexing.</p>
</section>
<section id="valid-barcodes" class="level4">
<h4 class="anchored" data-anchor-id="valid-barcodes">Valid Barcodes</h4>
<p>Fraction of reads with barcodes that match the whitelist after barcode correction.</p>
</section>
<section id="sequencing-saturation" class="level4">
<h4 class="anchored" data-anchor-id="sequencing-saturation">Sequencing Saturation</h4>
<p>The fraction of reads originating from an already-observed UMI. This is a function of library complexity and sequencing depth. More specifically, this is the fraction of confidently mapped, valid cell-barcode, valid UMI reads that had a non-unique (cell-barcode, UMI, gene). This metric was called “cDNA PCR Duplication” in versions of Cell Ranger prior to 1.2.</p>
</section>
<section id="q30-bases-in-barcode" class="level4">
<h4 class="anchored" data-anchor-id="q30-bases-in-barcode">Q30 Bases in Barcode</h4>
<p>Fraction of cell barcode bases with Q-score &gt;= 30, excluding very low quality/no-call (Q &lt;= 2) bases from the denominator.</p>
</section>
<section id="q30-bases-in-rna-read" class="level4">
<h4 class="anchored" data-anchor-id="q30-bases-in-rna-read">Q30 Bases in RNA Read</h4>
<p>Fraction of RNA read bases with Q-score &gt;= 30, excluding very low quality/no-call (Q &lt;= 2) bases from the denominator. This is Read 1 for the Single Cell 3’ v1 chemistry and Read 2 for the Single Cell 3’ v2 chemistry.</p>
</section>
<section id="q30-bases-in-sample-index" class="level4">
<h4 class="anchored" data-anchor-id="q30-bases-in-sample-index">Q30 Bases in Sample Index</h4>
<p>Fraction of sample index bases with Q-score &gt;= 30, excluding very low quality/no-call (Q &lt;= 2) bases from the denominator.</p>
</section>
<section id="q30-bases-in-umi" class="level4">
<h4 class="anchored" data-anchor-id="q30-bases-in-umi">Q30 Bases in UMI</h4>
<p>Fraction of UMI bases with Q-score &gt;= 30, excluding very low quality/no-call (Q &lt;= 2) bases from the denominator.</p>
</section>
</section>
<section id="qc-metrics-mapping" class="level3">
<h3 class="anchored" data-anchor-id="qc-metrics-mapping">QC metrics – Mapping</h3>
<p><img src="Aspose.Words.2e953e9a-44c0-496e-9758-25b7bd47b079.004.jpeg" class="img-fluid"></p>
<section id="reads-mapped-to-genome" class="level4">
<h4 class="anchored" data-anchor-id="reads-mapped-to-genome">Reads Mapped to Genome</h4>
<p>Fraction of reads that mapped to the genome.</p>
</section>
<section id="reads-mapped-confidently-to-genome" class="level4">
<h4 class="anchored" data-anchor-id="reads-mapped-confidently-to-genome">Reads Mapped Confidently to Genome</h4>
<p>Fraction of reads that mapped uniquely to the genome. If a gene mapped to exonic loci from a single gene and also to non-exonic loci, it is considered uniquely mapped to one of the exonic loci.</p>
</section>
<section id="reads-mapped-confidently-to-intergenic-regions" class="level4">
<h4 class="anchored" data-anchor-id="reads-mapped-confidently-to-intergenic-regions">Reads Mapped Confidently to Intergenic Regions</h4>
<p>Fraction of reads that mapped uniquely to an intergenic region of the genome.</p>
</section>
<section id="reads-mapped-confidently-to-intronic-regions" class="level4">
<h4 class="anchored" data-anchor-id="reads-mapped-confidently-to-intronic-regions">Reads Mapped Confidently to Intronic Regions</h4>
<p>Fraction of reads that mapped uniquely to an intronic region of the genome.</p>
</section>
<section id="reads-mapped-confidently-to-exonic-regions" class="level4">
<h4 class="anchored" data-anchor-id="reads-mapped-confidently-to-exonic-regions">Reads Mapped Confidently to Exonic Regions</h4>
<p>Fraction of reads that mapped uniquely to an exonic region of the genome.</p>
</section>
<section id="reads-mapped-confidently-to-transcriptome" class="level4">
<h4 class="anchored" data-anchor-id="reads-mapped-confidently-to-transcriptome">Reads Mapped Confidently to Transcriptome</h4>
<p>Fraction of reads that mapped to a unique gene in the transcriptome. The read must be consistent with annotated splice junctions. These reads are considered for UMI counting.</p>
</section>
<section id="reads-mapped-antisense-to-gene" class="level4">
<h4 class="anchored" data-anchor-id="reads-mapped-antisense-to-gene">Reads Mapped Antisense to Gene</h4>
<p>Fraction of reads confidently mapped to the transcriptome, but on the opposite strand of their annotated gene. A read is counted as antisense if it has any alignments that are consistent with an exon of a transcript but antisense to it, and has no sense alignments.</p>
</section>
</section>
</section>
<section id="ranked-barcode-plot" class="level2">
<h2 class="anchored" data-anchor-id="ranked-barcode-plot">Ranked Barcode Plot</h2>
<p>The Barcode Rank Plot under the “Cells” dashboard shows the distribution of barcode counts and which barcodes were inferred to be associated with cells. It is one of the most informative QC plots, it enables one to assess sample quality and to formulate hypothesis of what might have gone wrong if the experiment was not perfectly successful.</p>
<p>To obtain this plot, reads are grouped by barcode, the number of UMI is counted, resulting in a vector of UMI count per barcode (note: one barcode - one GEM!). The counts are then sorted and the vector is displayed in rank vs counts plot:</p>
<p>The y-axis is the number of UMI counts mapped to each barcode and the x-axis is the number of barcodes below that value.</p>
<p>Note that due to the high number of GEMs with at least one UMI the only way to visualize all the data is a log-log axes plot.</p>
<p>How does one interpret the plot? What to expect?</p>
<p>Ideally there is a steep dropoff separating high UMI count cells from low UMI count background noise:</p>
<p>A steep drop-off is indicative of good separation between the cell-associated barcodes and the barcodes associated with empty partitions.</p>
<p>Barcodes can be determined to be cell-associated based on their UMI count or by their RNA profiles, therefore some regions of the graph can contain both cell-associated and background-associated barcodes.</p>
<p>The color of the graph represents the local density of barcodes that are cell-associated.</p>
<p>In fact, the cutoff is determined with a two-step procedure:</p>
<ul>
<li>It uses a cutoff based on total UMI counts of each barcode to identify cells. This step identifies the primary mode of high RNA content cells.</li>
<li><img src="Aspose.Words.2e953e9a-44c0-496e-9758-25b7bd47b079.005.jpeg" class="img-fluid">Then the algorithm uses the RNA profile of each remaining barcode to determine if it is an “empty” or a cell containing partition. This second step captures low RNA content cells, whose total UMI counts may be similar to empty GEMs.</li>
</ul>
</section>
<section id="saturation---is-there-a-gain-in-sequencing-more" class="level2">
<h2 class="anchored" data-anchor-id="saturation---is-there-a-gain-in-sequencing-more">Saturation - is there a gain in sequencing more?</h2>
<p>The sequencing saturation plot allows the user to assess the relative tradeoffs of sequencing deeper or shallower. As sequencing saturation increases, the total number of molecules detected in the library increases, but with diminishing returns as saturation is approached.</p>
<p>A good rule of thumb for most cell types is that: An average of 40k reads per cell is a minimal sufficient that with 80k reads being usually an excellent depth. There is certainly gain in sequencing more but it is not cost-effective in general. So, it is important to evaluate if going deeper has a value to your scientific question.</p>
<p><img src="Aspose.Words.2e953e9a-44c0-496e-9758-25b7bd47b079.006.jpeg" class="img-fluid"><img src="Aspose.Words.2e953e9a-44c0-496e-9758-25b7bd47b079.007.jpeg" class="img-fluid"></p>
</section>
<section id="analysis-view" class="level2">
<h2 class="anchored" data-anchor-id="analysis-view">Analysis view</h2>
<p>The automated secondary analysis results can be viewed by clicking “Analysis” in the top left corner. The secondary analysis provides the following:</p>
<p>A dimensional reduction analysis which projects the cells into a 2-D space (t-SNE), including an automated clustering analysis which groups together cells that have similar expression profiles.</p>
<p><img src="Aspose.Words.2e953e9a-44c0-496e-9758-25b7bd47b079.008.jpeg" class="img-fluid"></p>
<p>A list of genes that are differentially expressed between the selected clusters</p>
<p>Plots showing the effect of decreased sequencing depth on observed library complexity and on median genes per cell detected</p>
</section>
<section id="troubleshooting-when-things-go-bad" class="level2">
<h2 class="anchored" data-anchor-id="troubleshooting-when-things-go-bad">Troubleshooting: when things go bad</h2>
<p><img src="Aspose.Words.2e953e9a-44c0-496e-9758-25b7bd47b079.009.jpeg" class="img-fluid"></p>
<p><img src="Aspose.Words.2e953e9a-44c0-496e-9758-25b7bd47b079.010.jpeg" class="img-fluid"></p>
<p>For other situations like these two below, there is usually little you can do and you’d better contact 10X genomics support and/or the sequencing core facility at your institution</p>
<p><img src="Aspose.Words.2e953e9a-44c0-496e-9758-25b7bd47b079.011.jpeg" class="img-fluid"></p>
<p><strong>Exercise 4</strong>: We provide you with some <code>web_summary.html</code> files. Use what you have learned above to evaluate each one of the experiments and write a short evaluation of what you observe at least ~50 words per each file. When you write a short summary, imagine you are reporting to your supervisor about how the experiment went.</p>
<p>Click the links and type Ctrl+S (Windows) or Cmd+S (Mac) to save the file to your computer. After that, open them in your browser.</p>
<ul>
<li>
<a href="https://raw.githubusercontent.com/sib-swiss/single-cell-python-training/main/exp1.html" download="exp1.html">Experiment 1</a>
</li>
<li>
<a href="https://raw.githubusercontent.com/sib-swiss/single-cell-python-training/main/exp2.html" download="exp2.html">Experiment 2</a>
</li>
<li>
<a href="https://raw.githubusercontent.com/sib-swiss/single-cell-python-training/main/exp3.html" download="exp3.html">Experiment 3</a>
</li>
<li>
<a href="https://raw.githubusercontent.com/sib-swiss/single-cell-python-training/main/exp4.html" download="exp4.html">Experiment 4</a>
</li>
<li>
<a href="https://raw.githubusercontent.com/sib-swiss/single-cell-python-training/main/exp5.html" download="exp5.html">Experiment 5</a>
</li>
<li>
<a href="https://raw.githubusercontent.com/sib-swiss/single-cell-python-training/main/exp6.html" download="exp6.html">Experiment 6</a>
</li>
<li>
<a href="https://raw.githubusercontent.com/sib-swiss/single-cell-python-training/main/exp7.html" download="exp7.html">Experiment 7</a>
</li>
<li>
<a href="https://raw.githubusercontent.com/sib-swiss/single-cell-python-training/main/exp8.html" download="exp8.html">Experiment 8</a>
</li>
<li>
<a href="https://raw.githubusercontent.com/sib-swiss/single-cell-python-training/main/exp9.html" download="exp9.html">Experiment 9</a>
</li>
</ul>


</section>
</div>
</section>
</div>
</section>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/sib-swiss\.github\.io\/single-cell-python-training\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>